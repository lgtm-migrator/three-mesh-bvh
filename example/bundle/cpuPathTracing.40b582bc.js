var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},a=e.parcelRequire4485;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in o){var a=o[e];delete o[e];var n={id:e,exports:{}};return t[e]=n,a.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},e.parcelRequire4485=a),a("27Lyk").register(JSON.parse('{"bTAAs":"cpuPathTracing.40b582bc.js","b4BBl":"generateAsync.worker.5bf93d10.js","aXY4O":"asyncGenerate.24234c67.js","kV5LX":"asyncGenerate.bdcabb76.js","cOWBq":"characterMovement.f9cd7440.js","9uBo5":"characterMovement.ae9e756b.js","dzSTI":"characterMovement.af1137e5.js","kRHgr":"cpuPathTracing.97298fda.js","1NA8R":"asyncGenerate.58c4bd60.js","c2tYY":"clippedEdges.4daa7d82.js"}'));var n=a("ilwiq"),r=a("5Rd1x"),i=a("7lx9d"),l=a("7ePFa"),s=a("RPVlj"),c=a("kp7Te");const d=new((n=a("ilwiq")).Vector3),m=new n.Vector3,h=new n.Vector3,u=[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]];function p(e,t){return function(e,t){return t+(1-t)*Math.pow(1-e,5)}(e,Math.pow((1-t)/(1+t),2))}function f(e,t){Math.abs(e.x)>.5?d.set(0,1,0):d.set(1,0,0),m.crossVectors(e,d).normalize(),h.crossVectors(e,m).normalize(),t.makeBasis(h,m,e)}function g(e,t,o){return o.addVectors(e,t).normalize()}function y(e,t,o){return e.dot(t)>0===e.dot(o)>0}const w=new((n=a("ilwiq")).Vector3),M=new n.Vector3,b=new n.Vector3,S=new n.Vector3,x=new n.Vector3(0,0,1),C=Math.PI;function z(e,t){const o=Math.tan(e),a=o*o,n=t*t;return(-1+Math.sqrt(1+n*a))/2}function B(e,t){const o=t*t,a=e.z,n=Math.pow(a,4);if(0===a)return 0;const r=Math.acos(e.z),i=Math.tan(r),l=Math.pow(i,2);return o/(Math.PI*n*Math.pow(o+l,2))}function v(e,t,o){const a=Math.acos(e.z),n=B(t,o),r=function(e,t){return 1/(1+z(e,t))}(a,o);return n*r*Math.max(0,e.dot(t))/e.z}const V=new((n=a("ilwiq")).Vector3),T=new n.Vector3,I=new n.Color,A=new n.Color(16777215);function F(e,t,o,a){const n=t.filteredSurfaceRoughness;!function(e,t,o,a,n,r){const i=w.set(t*e.x,o*e.y,e.z).normalize(),l=i.z<.9999?M.crossVectors(i,x).normalize():M.set(1,0,0),s=b.crossVectors(l,i),c=1/(1+i.z),d=Math.sqrt(a),m=n<c?n/c*C:C+(n-c)/(1-c)*C,h=d*Math.cos(m),u=d*Math.sin(m)*(n<c?1:i.z);l.multiplyScalar(h),s.multiplyScalar(u);const p=S.addVectors(l,s).addScaledVector(i,Math.sqrt(Math.max(0,1-h*h-u*u)));p.x*=t,p.y*=o,p.z=Math.max(0,p.z),p.normalize(),r.copy(p)}(e,n,n,Math.random(),Math.random(),T),a.copy(e).reflect(T).multiplyScalar(-1)}function P(e,t,o,a,r){const{metalness:i,ior:l}=o,{frontFace:s}=a,c=a.filteredSurfaceRoughness;g(e,t,T);const d=s?1/l:l,m=function(e,t,o){const a=Math.acos(e.z),n=Math.acos(t.z);return 1/(1+z(a,o)+z(n,o))}(t,e,c),h=B(T,c);let u=p(t.dot(T),d);const f=Math.min(e.z,1);d*Math.sqrt(1-f*f)>1&&(u=1),r.lerpColors(A,o.color,i).multiplyScalar(m*h/(4*Math.abs(t.z*e.z))).multiplyScalar(n.MathUtils.lerp(u,1,i)).multiplyScalar(t.z)}function W(e,t,o,a){const{roughness:r,ior:i}=o,{frontFace:l}=t,s=l?1/i:i;V.copy(e).multiplyScalar(-1),function(e,t,o,a){let n=Math.min(-e.dot(t),1);d.copy(e).addScaledVector(t,n).multiplyScalar(o),a.copy(t).multiplyScalar(-Math.sqrt(Math.abs(1-d.lengthSq()))).add(d)}(V,new n.Vector3(0,0,1),s,a),V.randomDirection().multiplyScalar(r),a.add(V)}function k(e,t,o,a){const{ior:r,metalness:i,transmission:l}=o,{frontFace:s}=a,c=s?1/r:r,d=Math.min(e.z,1),m=Math.sqrt(1-d*d);let h=p(d,c);c*m>1&&(h=1);let u=0,f=0,y=0;t.z<0?y=function(e,t,o,a){const{ior:n}=o,{frontFace:r}=a,i=r?1/n:n,l=Math.min(e.z,1),s=Math.sqrt(1-l*l);let c=p(l,i);return i*s>1?0:1/(1-c)}(e,0,o,a):(u=function(e,t,o,a){const n=a.filteredSurfaceRoughness;return g(t,e,T),v(t,T,n)/(4*t.dot(T))}(e,t,0,a),f=function(e,t,o,a){return t.z/Math.PI}(0,t));const w=n.MathUtils.lerp(h,1,i),M=.5+.5*i;return u*l*w+y*l*(1-w)+u*(1-l)*M+f*(1-l)*(1-M)}function D(e,t,o,a,n){t.z<0?function(e,t,o,a,n){const{metalness:r,transmission:i}=o;n.copy(o.color).multiplyScalar(1-r).multiplyScalar(i)}(0,0,o,0,n):(!function(e,t,o,a,n){const{metalness:r,transmission:i}=o;n.copy(o.color).multiplyScalar((1-r)*t.z/Math.PI/Math.PI).multiplyScalar(1-i)}(0,t,o,0,n),n.multiplyScalar(1-o.transmission),P(e,t,o,a,I),n.add(I))}function G(e,t,o,a){const r=a.direction,{ior:i,metalness:l,transmission:s}=o,{frontFace:c}=t,d=c?1/i:i,m=Math.min(e.z,1),h=Math.sqrt(1-m*m);let u=p(m,d);if(d*h>1&&(u=1),Math.random()<s){const a=n.MathUtils.lerp(u,1,l);Math.random()<a?F(e,t,0,r):W(e,t,o,r)}else{const o=.5+.5*l;Math.random()<o?F(e,t,0,r):function(e,t,o,a){a.randomDirection(),a.z+=1,a.normalize()}(0,0,0,r)}a.pdf=k(e,r,o,t),D(e,r,o,t,a.color)}var R=a("jiuw3"),H=a("4CEV9"),L=a("8todg");let j,E,q,U,N,O,$,X,Y,_,Z,J,Q,K,ee,te,oe,ae,ne,re,ie;n.Mesh.prototype.raycast=H.acceleratedRaycast,n.BufferGeometry.prototype.computeBoundsTree=H.computeBoundsTree,n.BufferGeometry.prototype.disposeBoundsTree=H.disposeBoundsTree;const le=new n.Triangle,se=new n.Vector3,ce=new n.Vector3,de=new n.Vector3,me=new n.Vector3,he=new n.Spherical,ue=new n.Matrix4,pe=new n.Matrix4,fe=new n.Vector3,ge=new n.Color,ye=new n.Vector3,we={},Me={model:"Dragon",resolution:{resolutionScale:.5,smoothImageScaling:!1,stretchImage:!0},pathTracing:{pause:!1,displayScanLine:!1,antialiasing:!0,bounces:10,filterGlossyFactor:.5,smoothNormals:!0,directLightSampling:!0},material:{color:"#0099ff",emissive:"#000000",emissiveIntensity:1,roughness:.1,metalness:0,ior:1.8,transmission:0},floor:{enable:!0,color:"#7f7f7f",roughness:.1,metalness:.1,width:10,height:10},light:{enable:!0,position:"Diagonal",intensity:30,color:"#ffffff",width:1,height:1},environment:{skyMode:"sky",skyIntensity:.025}};function be(e,t=!0){const o=[],a=[];for(let r=0,i=e.length;r<i;r++){const i=e[r],l=e[r].geometry,s=t?l.clone():t;i.updateMatrixWorld(),s.applyMatrix4(i.matrixWorld);const c=s.attributes.position.count,d=new Uint8Array(c).fill(r);s.setAttribute("materialIndex",new n.BufferAttribute(d,1,!1)),o.push(s),a.push(i.material)}return{geometry:l.mergeBufferGeometries(o,!1),materials:a}}function Se(){function e(e,t){X&&X.image.width===e&&X.image.height===t||(X&&X.dispose(),X=new n.DataTexture(new Float32Array(e*t*4),e,t,n.RGBAFormat,n.FloatType),xe())}E.aspect=window.innerWidth/window.innerHeight,E.updateProjectionMatrix();const t=window.devicePixelRatio,o=Me.resolution.resolutionScale;Me.resolution.stretchImage?(K.style.width=`${window.innerWidth}px`,K.style.height=`${window.innerHeight}px`,q.setSize(window.innerWidth,window.innerHeight),q.setPixelRatio(t*o),e(Math.floor(window.innerWidth*t*o),Math.floor(window.innerHeight*t*o))):(K.style.width=window.innerWidth*o+"px",K.style.height=window.innerHeight*o+"px",q.setSize(Math.floor(window.innerWidth*o),Math.floor(window.innerHeight*o)),q.setPixelRatio(t),e(Math.floor(window.innerWidth*t*o),Math.floor(window.innerHeight*t*o))),q.domElement.style.imageRendering=Me.resolution.smoothImageScaling?"auto":"pixelated"}function xe(){X.image.data.fill(0),X.needsUpdate=!0,Y=0,_=function*(){const{width:e,height:t,data:o}=X.image,a=parseInt(Me.pathTracing.bounces),r=parseFloat(Me.environment.skyIntensity),i=Me.environment.skyMode,l=Me.pathTracing.smoothNormals,s=new n.Color,c=new n.Color,d=new n.Vector3,m=new n.Vector3,h=new n.Vector2,p=new Array(a).fill().map((()=>new n.Ray)),g=new n.Vector3(0,0,1).transformDirection(re.matrixWorld),w=re.scale.x,M=re.scale.y,b=new n.Raycaster;b.firstHitOnly=!0;const S=new n.Ray,x={pdf:0,color:new n.Color,direction:new n.Vector3};let C=performance.now();te=performance.now(),oe=0,J=100,Q.style.visibility=Me.pathTracing.displayScanLine?"visible":"hidden",ae.material.side=n.DoubleSide,ne.forEach((e=>{e.side=n.DoubleSide}));for(;;){let a=0,n=0;if(Me.pathTracing.antialiasing){const o=Y%u.length;[a,n]=u[o],a=a/16/e,n=n/16/t}for(let r=t-1;r>=0;r--)for(let i=0;i<e;i++){h.set(a+i/(e-1),n+r/(t-1)),b.setFromCamera({x:2*h.x-1,y:2*h.y-1},E),ye.set(0,0,-1).transformDirection(E.matrixWorld),S.direction.copy(b.ray.direction),S.origin.copy(b.ray.origin).addScaledVector(b.ray.direction,E.near/b.ray.direction.dot(ye)),s.set(0),B(S,s);const l=4*(r*e+i),c=o[l+0],d=o[l+1],m=o[l+2];o[l+0]+=(s.r-c)/(Y+1),o[l+1]+=(s.g-d)/(Y+1),o[l+2]+=(s.b-m)/(Y+1),o[l+3]=1;const u=performance.now()-C;u>16&&(oe+=u,J=100*r/t,yield,C=performance.now())}Y++}function z(e,t,o){const a=e.object,n=a.geometry.attributes.position,r=a.geometry.attributes.normal,i=a.geometry.attributes.materialIndex,s=e.face,c=e.face.normal;if(l){const t=e.point;le.a.fromBufferAttribute(n,s.a),le.b.fromBufferAttribute(n,s.b),le.c.fromBufferAttribute(n,s.c),se.fromBufferAttribute(r,s.a),ce.fromBufferAttribute(r,s.b),de.fromBufferAttribute(r,s.c),le.getBarycoord(t,me),m.setScalar(0).addScaledVector(se,me.x).addScaledVector(ce,me.y).addScaledVector(de,me.z).normalize()}else m.copy(c);c.transformDirection(a.matrixWorld),m.transformDirection(a.matrixWorld);const d=c.dot(t.direction)<0;d||(m.multiplyScalar(-1),c.multiplyScalar(-1));let h=a.material;if(i){const e=i.getX(s.a);h=ne[e]}e.material=h,e.normal=m,e.geometryNormal=c,e.frontFace=d,e.filteredSurfaceRoughness=Math.min(Math.max(1e-6,h.roughness,o*Me.pathTracing.filterGlossyFactor*5),1)}function B(e,t){let o=e,n=0,r=0;c.set(16777215);for(let e=0;e<a;e++){let a=null;b.ray.copy(o);const i=[ae];if(Me.light.enable&&i.push(re),Me.floor.enable&&i.push(ie),a=b.intersectObjects(i,!0)[0],!a){v(o.direction,ge),ge.multiply(c),t.add(ge);break}if(a.object===re){if(0===e){const e=re.material.color;t.r=Math.min(e.r,1),t.g=Math.min(e.g,1),t.b=Math.min(e.b,1)}else if(o.direction.dot(g)<0){const e=n/(n+a.distance*a.distance/(w*M*-o.direction.dot(g)));t.r+=e*c.r*re.material.color.r,t.g+=e*c.g*re.material.color.g,t.b+=e*c.b*re.material.color.b}break}{z(a,o,r);const{material:l}=a,s=p[e];if(f(a.normal,ue),pe.copy(ue).invert(),Me.light.enable&&(ye.set(Math.random()-.5,Math.random()-.5,0).applyMatrix4(re.matrixWorld),s.origin.copy(a.point).addScaledVector(a.geometryNormal,1e-7),s.direction.subVectors(ye,s.origin).normalize(),s.direction.dot(g)<0&&y(s.direction,a.normal,a.geometryNormal))){const e=w*M,n=s.origin.distanceToSquared(ye)/(e*-s.direction.dot(g));b.ray.copy(s);const r=b.intersectObjects(i,!0)[0];if(r&&r.object===re){fe.copy(o.direction).applyMatrix4(pe).multiplyScalar(-1).normalize(),ye.copy(s.direction).applyMatrix4(pe).normalize(),fe.normalize(),D(fe,ye,l,a,ge);const e=n/(k(fe,ye,l,a)+n);t.r+=re.material.color.r*c.r*ge.r*e/n,t.g+=re.material.color.g*c.g*ge.g*e/n,t.b+=re.material.color.b*c.b*ge.b*e/n}}fe.copy(o.direction).applyMatrix4(pe).multiplyScalar(-1).normalize(),G(fe,a,l,x),d.addVectors(fe,x.direction).normalize(),r+=Math.sin(Math.acos(d.z)),s.direction.copy(x.direction).applyMatrix4(ue).normalize();const m=s.direction.dot(a.geometryNormal)<0;s.origin.copy(a.point).addScaledVector(a.geometryNormal,m?-1e-7:1e-7);const{emissive:h,emissiveIntensity:u}=l;if(t.r+=u*h.r*c.r,t.g+=u*h.g*c.g,t.b+=u*h.b*c.b,x.pdf<=0||!y(s.direction,a.normal,a.geometryNormal))break;x.color.multiplyScalar(1/x.pdf),c.multiply(x.color),o=s,n=x.pdf}}}function v(e,t){if("checkerboard"===i){he.setFromVector3(e);const o=Math.PI/10,a=Math.floor(he.theta/o)%2==0===(Math.floor(he.phi/o)%2==0);t.set(a?0:16777215).multiplyScalar(1.5),t.multiplyScalar(r)}else if("sun"===i){se.setScalar(1).normalize();let o=Math.max(0,e.dot(se)+1)/2;if(o*=o,t.r=n.MathUtils.lerp(.01,.5,o),t.g=n.MathUtils.lerp(.01,.7,o),t.b=n.MathUtils.lerp(.01,1,o),o>.95){let e=(o-.95)/.05;e*=e,t.r=n.MathUtils.lerp(.5,10,e),t.g=n.MathUtils.lerp(.7,10,e),t.b=n.MathUtils.lerp(1,10,e)}t.multiplyScalar(r)}else{const o=(e.y+.5)/2;t.r=n.MathUtils.lerp(1,.5,o),t.g=n.MathUtils.lerp(1,.7,o),t.b=n.MathUtils.lerp(1,1,o),t.multiplyScalar(r)}}}(),Z=0,Q.style.visibility="hidden",J=100,re.scale.set(Me.light.width,Me.light.height,1),re.material.color.set(Me.light.color).multiplyScalar(Me.light.intensity),re.visible=Me.light.enable,ie.scale.set(Me.floor.width,Me.floor.height,1),ie.material.color.set(Me.floor.color),ie.material.roughness=Math.pow(Me.floor.roughness,2),ie.material.metalness=Me.floor.metalness,ie.visible=Me.floor.enable}function Ce(e){let t=.001*(e=e||0);const o=Math.floor(t/60);t-=60*o;return`${(o<10?"0":"")+o}m ${(t<10?"0":"")+t.toFixed(3)}s`}!function(){q=new n.WebGLRenderer({antialias:!0}),q.setPixelRatio(window.devicePixelRatio),q.setSize(window.innerWidth,window.innerHeight),q.setClearColor(0,1),q.outputEncoding=n.sRGBEncoding,K=document.createElement("div"),K.style.position="absolute",K.style.inset="0",K.style.margin="auto",K.style.zIndex="-1",document.body.appendChild(K),K.appendChild(q.domElement),Q=document.createElement("div"),Q.style.width="100%",Q.style.position="absolute",Q.style.borderBottom="1px solid #e91e63",Q.style.visibility="hidden",K.appendChild(Q),ee=document.getElementById("output"),O=new s.FullScreenQuad(new n.MeshBasicMaterial),O.material.transparent=!0,j=new n.Scene,E=new n.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,50),E.position.set(-2.5,1.5,2.5),E.far=100,E.updateProjectionMatrix(),U=new n.HemisphereLight(16777215,6710886,1),j.add(U),re=new n.Mesh(new n.PlaneBufferGeometry(1,1,1,1),new n.MeshBasicMaterial({side:n.DoubleSide})),re.position.set(2,2,2),re.lookAt(0,0,0),j.add(re),ie=new n.Mesh(new n.PlaneBufferGeometry(1,1,1,1),new n.MeshStandardMaterial({side:n.DoubleSide})),ie.rotation.x=-Math.PI/2,ie.scale.setScalar(1),ie.material.ior=1.6,ie.material.transmission=0,j.add(ie),$=new r.OrbitControls(E,q.domElement),$.addEventListener("change",xe),window.addEventListener("resize",Se,!1),Se(),we.Sphere=null;{const e=new n.Mesh(new n.SphereGeometry(1,100,50),new n.MeshStandardMaterial),{geometry:t,materials:o}=be([e],!0),a=new n.Mesh(t,new n.MeshStandardMaterial);j.add(a),t.computeBoundsTree({strategy:H.SAH,maxLeafTris:1}),we.Sphere={mesh:a,materials:o,floorHeight:-1}}we["Cornell Box"]=null;{const e=new n.PlaneBufferGeometry(1,1,1,1),t=new n.Mesh(e,new n.MeshStandardMaterial({color:60928,side:n.DoubleSide}));t.rotation.y=Math.PI/2,t.position.x=-2,t.scale.setScalar(4),t.updateMatrixWorld(!0);const o=new n.Mesh(e,new n.MeshStandardMaterial({color:15597568}));o.rotation.y=Math.PI/2,o.position.x=2,o.scale.setScalar(4),o.updateMatrixWorld(!0);const a=new n.Mesh(e,new n.MeshStandardMaterial({color:15658734}));a.position.z=-2,a.scale.setScalar(4),a.updateMatrixWorld(!0);const r=new n.Mesh(e.clone(),new n.MeshStandardMaterial({color:15658734}));r.rotation.x=Math.PI/2,r.position.y=2,r.scale.setScalar(4),r.updateMatrixWorld(!0);const i=new n.Mesh(new n.BoxGeometry(1,2,1),new n.MeshStandardMaterial({side:n.DoubleSide}));i.position.y=-1,i.position.x=-.6,i.position.z=-.25,i.rotation.y=Math.PI/4;const l=new n.Mesh(new n.BoxGeometry(1,1,1),new n.MeshStandardMaterial({side:n.DoubleSide}));l.position.y=-1.5,l.position.x=.75,l.position.z=.5,l.rotation.y=-Math.PI/8;const{geometry:s,materials:c}=be([i,l,t,o,a,r],!0),d=new n.Mesh(s,new n.MeshStandardMaterial);j.add(d),s.computeBoundsTree({strategy:H.SAH,maxLeafTris:1}),we["Cornell Box"]={mesh:d,materials:c,floorHeight:-2}}we.Dragon=null,(new i.GLTFLoader).load("../models/DragonAttenuation.glb",(e=>{let t;e.scene.traverse((e=>{e.isMesh&&"Dragon"===e.name&&(t=e)})),t.material=new n.MeshStandardMaterial,t.geometry.center().scale(.25,.25,.25).rotateX(Math.PI/2),t.position.set(0,0,0),t.scale.set(1,1,1),t.quaternion.identity();const{geometry:o,materials:a}=be([t],!0),r=new n.Mesh(o,new n.MeshStandardMaterial),i=new L.GenerateMeshBVHWorker;i.generate(o,{maxLeafTris:1,strategy:H.SAH}).then((e=>{we.Dragon={mesh:r,materials:a,floorHeight:t.geometry.boundingBox.min.y},o.boundsTree=e,i.dispose(),j.add(r)}))})),we.Engine=null,(new i.GLTFLoader).setMeshoptDecoder(c.MeshoptDecoder).load("../models/internal_combustion_engine/model.gltf",(e=>{const t=e.scene.children[0],o=t.geometry,a=new n.BufferGeometry,r=o.attributes.position,i=o.attributes.normal,l=new n.BufferAttribute(new Float32Array(3*r.count),3,!1),s=new n.BufferAttribute(new Float32Array(3*i.count),3,!1),c=new n.Vector3;for(let e=0,t=r.count;e<t;e++)c.fromBufferAttribute(r,e),l.setXYZ(e,c.x,c.y,c.z),c.fromBufferAttribute(i,e),c.multiplyScalar(1/127),s.setXYZ(e,c.x,c.y,c.z);t.scale.multiplyScalar(5),t.updateMatrixWorld(),a.setAttribute("position",l),a.setAttribute("normal",s),a.setAttribute("materialIndex",new n.BufferAttribute(new Uint8Array(l.count),1,!1)),a.setIndex(o.index),a.applyMatrix4(t.matrixWorld).center(),a.computeBoundingBox();const d=new n.Mesh(a,new n.MeshStandardMaterial),m=new L.GenerateMeshBVHWorker;m.generate(a,{maxLeafTris:1,strategy:H.CENTER}).then((e=>{we.Engine={mesh:d,materials:[new n.MeshStandardMaterial],floorHeight:a.boundingBox.min.y},a.boundsTree=e,m.dispose(),j.add(d)}))})),Y=0,N=new n.Clock;const e=new R.GUI;e.add(Me,"model",Object.keys(we)).onChange(xe);const t=e.addFolder("resolution");t.add(Me.resolution,"resolutionScale",.1,1,.01).onChange(Se),t.add(Me.resolution,"smoothImageScaling").onChange(Se),t.add(Me.resolution,"stretchImage").onChange(Se),t.open();const o=e.addFolder("path tracing");o.add(Me.pathTracing,"pause"),o.add(Me.pathTracing,"displayScanLine").onChange((e=>{Q.style.visibility=e?"visible":"hidden"})),o.add(Me.pathTracing,"antialiasing").onChange(xe),o.add(Me.pathTracing,"directLightSampling").onChange(xe),o.add(Me.pathTracing,"smoothNormals").onChange(xe),o.add(Me.pathTracing,"bounces",1,50,1).onChange(xe),o.add(Me.pathTracing,"filterGlossyFactor",0,1,.001).onChange(xe),o.open();const a=e.addFolder("model");a.addColor(Me.material,"color").onChange(xe),a.addColor(Me.material,"emissive").onChange(xe),a.add(Me.material,"emissiveIntensity",0,5,.001).onChange(xe),a.add(Me.material,"roughness",0,1,.001).onChange(xe),a.add(Me.material,"metalness",0,1,.001).onChange(xe),a.add(Me.material,"transmission",0,1,.001).onChange(xe),a.add(Me.material,"ior",1,2.5,.001).onChange(xe),a.open();const l=e.addFolder("floor");l.add(Me.floor,"enable").onChange(xe),l.addColor(Me.floor,"color").onChange(xe),l.add(Me.floor,"roughness",0,1,.001).onChange(xe),l.add(Me.floor,"metalness",0,1,.001).onChange(xe),l.add(Me.floor,"width",3,20,.001).onChange(xe),l.add(Me.floor,"height",3,20,.001).onChange(xe);const d=e.addFolder("light");d.add(Me.light,"enable").onChange(xe),d.addColor(Me.light,"color").onChange(xe),d.add(Me.light,"intensity",0,100,.001).onChange(xe),d.add(Me.light,"width",0,5,.001).onChange(xe),d.add(Me.light,"height",0,5,.001).onChange(xe),d.add(Me.light,"position",["Diagonal","Above","Below"]).onChange(xe);const m=e.addFolder("environment");m.add(Me.environment,"skyMode",["sky","sun","checkerboard"]).onChange(xe),m.add(Me.environment,"skyIntensity",0,5,.001).onChange(xe),Se()}(),function e(){requestAnimationFrame(e);for(const e in we)we[e]&&(we[e].mesh.visible=!1);if(we[Me.model]){const e=we[Me.model];e.mesh.visible=!0,ae=e.mesh,ne=e.materials,ie.position.y=e.floorHeight,ne.forEach((e=>{void 0===e.ior&&(e.ior=1),void 0===e.transmission&&(e.transmission=0)}));const t=ne[0];switch(t.color.set(Me.material.color).convertSRGBToLinear(),t.emissive.set(Me.material.emissive).convertSRGBToLinear(),t.emissiveIntensity=parseFloat(Me.material.emissiveIntensity),t.ior=parseFloat(Me.material.ior),t.metalness=parseFloat(Me.material.metalness),t.transmission=parseFloat(Me.material.transmission),t.roughness=Math.pow(parseFloat(Me.material.roughness),2),Me.light.position){case"Below":re.rotation.set(-Math.PI/2,0,0),re.position.set(0,e.floorHeight+.001,0);break;case"Above":re.rotation.set(Math.PI/2,0,0),re.position.set(0,1.999,0);break;default:re.position.set(2,2,2),re.lookAt(0,0,0)}}else ae=null,ne=null,ie.position.y=0;let t=0;Z>150&&(t=Math.min((Z-150)/150,1));Q.style.bottom=`${J}%`,Me.resolution.stretchImage?Q.style.borderBottomWidth=`${Math.ceil(1/Me.resolution.resolutionScale)}px`:Q.style.borderBottomWidth="1px";q.render(j,E),q.autoClear=!1,O.material.map=X,O.material.opacity=t,O.render(q),q.autoClear=!0,ae&&!Me.pathTracing.pause&&_.next();X.needsUpdate=!0,q.compile(O._mesh),Z<300&&(Z+=1e3*N.getDelta());ee.innerText=`completed samples : ${Y}\ncomputation time  : ${Ce(oe)}\nelapsed time      : ${Ce(performance.now()-te)}`}();
//# sourceMappingURL=cpuPathTracing.40b582bc.js.map
